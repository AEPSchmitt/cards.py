<!DOCTYPE html>
<html>
  <head>
    <title>{{ _title }}</title>

    <link rel="stylesheet" type="text/css" href="css/index.css">
    <link rel="stylesheet" type="text/css" href="css/cards.css">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Cards generated using https://github.com/jhauberg/cards.py {{ _program_version }}">

    <script type="text/javascript">
      function removeOverlappingCutGuides() {
        var elements = document.getElementsByClassName('cut-guide');

        if (elements.length > 0) {
          for (var i = 0; i < elements.length; i++) {
            var element = elements[i];
            var elementFrame = element.getBoundingClientRect();

            for (var j = 0; j < elements.length; j++) {
              if (i == j) {
                continue;
              }

              var otherElement = elements[j]
              var otherElementFrame = otherElement.getBoundingClientRect();

              var overlap = !(elementFrame.right < otherElementFrame.left ||
                              elementFrame.left > otherElementFrame.right ||
                              elementFrame.bottom < otherElementFrame.top ||
                              elementFrame.top > otherElementFrame.bottom)

              if (overlap) {
                otherElement.parentNode.removeChild(otherElement);
              }
            }
          }
        }
      }

      function toggleVisibility(className) {
        var elements = document.getElementsByClassName(className);

        if (elements.length > 0) {
          for (var i = 0; i < elements.length; i++) {
            var element = elements[i];
            var previousVisibility = element.style.visibility;

            element.style.visibility =
              (!previousVisibility || previousVisibility == 'visible') ?
                'hidden' :
                'visible';
          }

          return elements[0].style.visibility;
        }
      }

      function getActionFromVisibility(visibility) {
        return (visibility == 'visible') ? 'HIDE' : 'SHOW';
      }

      function toggleFooter() {
        visibility = toggleVisibility('page-footer');

        if (visibility) {
          var toggleButton = document.getElementById("toggle-footer");

          toggleButton.innerHTML = '<b>' + getActionFromVisibility(visibility) + '</b><br />FOOTER'
        }
      }

      function toggleCutGuides() {
        visibility = toggleVisibility('cut-guide');

        if (visibility) {
          var toggleButton = document.getElementById("toggle-cut-guides");

          toggleButton.innerHTML = '<b>' + getActionFromVisibility(visibility) + '</b><br />CUT GUIDES'
        }
      }

      window.onload = function() {
        removeOverlappingCutGuides();
      };
    </script>
  </head>
  <body>
    <div class="ui">
      <button id="toggle-footer" class="ui-button ui-button-toggle" onclick="toggleFooter();">
        <b>HIDE</b><br />FOOTER
      </button>
      <button id="toggle-cut-guides" class="ui-button ui-button-toggle" onclick="toggleCutGuides();">
        <b>HIDE</b><br />CUT GUIDES
      </button>
      <button class="ui-button ui-button-print" onclick="window.print();">
        <b>PRINT</b>
      </button>
    </div>

    {{ _pages }}
  </body>
</html>
